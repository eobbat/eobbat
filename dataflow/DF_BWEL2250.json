{
	"name": "DF_BWEL2250",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "CSV_WEL_TEISU_M",
						"type": "DatasetReference"
					},
					"name": "csvdata"
				},
				{
					"dataset": {
						"referenceName": "DB_TENPO_EXEC_SERVER_M",
						"type": "DatasetReference"
					},
					"name": "dbTenpo"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "csvdata2"
				},
				{
					"name": "csvdata3"
				},
				{
					"name": "chkTencd"
				},
				{
					"name": "chkItemcd"
				},
				{
					"name": "chkTeisu"
				},
				{
					"name": "chkExistsTencd"
				}
			],
			"script": "source(output(\n\t\tten_cd as string,\n\t\titem_cd as string,\n\t\ttei_su as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tpartitionBy('hash', 1)) ~> csvdata\nsource(output(\n\t\tkg1_cd as string,\n\t\tten_cd as string,\n\t\tserver_id_bat as string,\n\t\tserver_id_web as string,\n\t\texec_mode as string,\n\t\texec_date as string,\n\t\tcreate_date as timestamp,\n\t\tcreate_user as string,\n\t\tupdate_date as timestamp,\n\t\tupdate_user as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> dbTenpo\ncsvdata derive(create_user = upper('BWEL2250'),\n\t\tcreate_date = currentTimestamp()) ~> csvdata2\ncsvdata2 window(over(line_no = rowNumber())) ~> csvdata3\ncsvdata3 split(between(length(coalesce(ten_cd,'')),1,6),\n\tdisjoint: false) ~> chkTencd@(chkTencdOK, chkTencdNG)\nchkTencd@chkTencdOK split(between(length(coalesce(item_cd,'')),1,13),\n\tdisjoint: false) ~> chkItemcd@(chkItemcdOK, chkItemcdNG)\nchkItemcd@chkItemcdOK split(isDecimal(tei_su),\n\tdisjoint: false) ~> chkTeisu@(chkTeisuOK, chkTeisuNG)\nchkTeisu@chkTeisuOK, dbTenpo exists(chkTeisu@chkTeisuOK@ten_cd == dbTenpo@ten_cd,\n\tnegate:false,\n\tbroadcast: 'auto')~> chkExistsTencd"
		}
	}
}